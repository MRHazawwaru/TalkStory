"use strict";(self.webpackChunkTalkStory=self.webpackChunkTalkStory||[]).push([[508],{392:(t,a,e)=>{e.d(a,{A:()=>s});const o="https://story-api.dicoding.dev/v1",s={register:async(t,a,e)=>(await fetch(`${o}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:a,password:e})})).json(),login:async(t,a)=>(await fetch(`${o}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})})).json(),getStories:async t=>(await fetch(`${o}/stories`,{headers:{Authorization:`Bearer ${t}`}})).json(),async addStory({token:t,description:a,image:e,lat:s,lon:i}){const r=new FormData;return r.append("description",a),r.append("photo",e),s&&i&&(r.append("lat",s),r.append("lon",i)),(await fetch(`${o}/stories`,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r})).json()}}},508:(t,a,e)=>{e.r(a),e.d(a,{default:()=>i});var o=e(392),s=e(815);class i{constructor(t){this.view=t,this.init()}async init(){await this.view.render(),await this.loadStories()}async loadStories(){try{const t=localStorage.getItem("token"),a=await o.A.getStories(t),e=await Promise.all(a.listStory.map((async t=>{const a=t.lat&&t.lon?await(0,s.p)(t.lat,t.lon):"Tanpa Lokasi";return{...t,locationName:a}})));this.view.showStories(e)}catch(t){console.error("Gagal memuat daftar cerita:",t),this.view.showAlert("Gagal","Gagal memuat cerita.","error")}}}},815:(t,a,e)=>{async function o(t,a){try{const e=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${a}`,o=await fetch(e,{headers:{"User-Agent":"TalkStoryApp/1.0"}}),s=(await o.json()).address||{};return`${s.village||s.town||s.city||""}, ${s.state||s.region||""}`}catch{return"Tanpa Lokasi"}}e.d(a,{p:()=>o})}}]);